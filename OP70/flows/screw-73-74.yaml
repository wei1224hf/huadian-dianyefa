- id: 71f537202ea9cf55
  type: tab
  label: screw-73-74
  disabled: false
  info: ''
  env: []
- id: 8d4d4b53cf1b63e2
  type: modbus-read
  z: 71f537202ea9cf55
  name: screw-front
  topic: ''
  showStatusActivities: false
  logIOActivities: false
  showErrors: false
  showWarnings: true
  unitid: '1'
  dataType: HoldingRegister
  adr: '31'
  quantity: '2'
  rate: '300'
  rateUnit: ms
  delayOnStart: false
  startDelayTime: ''
  server: 9a4dd78996491658
  useIOFile: false
  ioFile: ''
  useIOForPayload: false
  emptyMsgOnFail: false
  x: 240
  'y': 280
  wires:
    - - 46fcefbc01d35a56
      - c2215fbee5d7646e
      - 8c0135732e0ed9b9
    - []
- id: 4dab851a3090a4ee
  type: modbus-write
  z: 71f537202ea9cf55
  name: screw-front
  showStatusActivities: false
  showErrors: false
  showWarnings: true
  unitid: ''
  dataType: HoldingRegister
  adr: '3'
  quantity: '1'
  server: 9a4dd78996491658
  emptyMsgOnFail: false
  keepMsgProperties: false
  delayOnStart: false
  startDelayTime: ''
  x: 1490
  'y': 440
  wires:
    - []
    - []
- id: 49312cbe0536496d
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '1'
  payloadType: num
  x: 1190
  'y': 440
  wires:
    - - 4dab851a3090a4ee
- id: 1916e26398944d20
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '8'
  payloadType: num
  x: 1190
  'y': 480
  wires:
    - - 4dab851a3090a4ee
- id: dbb6283463f60b0e
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '0'
  payloadType: num
  x: 1190
  'y': 520
  wires:
    - - 4dab851a3090a4ee
- id: 182b0b97b21da321
  type: trigger
  z: 71f537202ea9cf55
  name: ''
  op1: '1'
  op2: '0'
  op1type: str
  op2type: str
  duration: '-250'
  extend: false
  overrideDelay: false
  units: ms
  reset: ''
  bytopic: all
  topic: topic
  outputs: 1
  x: 750
  'y': 460
  wires:
    - - 7f9f5dfb8250b123
- id: 9d8c504c1ac36899
  type: function
  z: 71f537202ea9cf55
  name: screw_front
  func: |-
    var val = 0;
    if (msg.payload.screw_up_run==1){
        val += 1;
    }
    if (msg.payload.screw_up_clockwise==1){
        val += 2;
    }
    if (msg.payload.screw_up_pause == 1) {
        val += 4;
    }
    if (msg.payload.screw_up_reset == 1) {
        val += 8;
    }
    msg.payload = val;
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 1090
  'y': 380
  wires:
    - - ecce777fee31e872
- id: 46fcefbc01d35a56
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: IO_70.AI.screw_front_error
      pt: global
      to: 'payload[0]'
      tot: msg
    - t: set
      p: IO_70.AI.screw_front_status
      pt: global
      to: 'payload[1]'
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 460
  'y': 300
  wires:
    - []
- id: 7f9f5dfb8250b123
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: payload
      pt: msg
      to: IO_70.AI
      tot: global
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 950
  'y': 460
  wires:
    - - 9d8c504c1ac36899
      - 9ce39f4bd52c4271
- id: c093bb83b677bf58
  type: modbus-read
  z: 71f537202ea9cf55
  name: front
  topic: ''
  showStatusActivities: false
  logIOActivities: false
  showErrors: false
  showWarnings: true
  unitid: ''
  dataType: HoldingRegister
  adr: '25'
  quantity: '2'
  rate: '200'
  rateUnit: ms
  delayOnStart: false
  startDelayTime: ''
  server: 9a4dd78996491658
  useIOFile: false
  ioFile: ''
  useIOForPayload: false
  emptyMsgOnFail: false
  x: 650
  'y': 280
  wires:
    - - d514673c90fffe90
    - []
- id: d514673c90fffe90
  type: function
  z: 71f537202ea9cf55
  name: 完成扭矩
  func: |-
    var data = msg.payload[0] + msg.payload[1] * 0xff;
    if (!Number.isNaN(data)) {
        msg.payload = data;
        return msg;
    }
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 800
  'y': 280
  wires:
    - - c52a9f97c85b9848
- id: c52a9f97c85b9848
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: IO_70.AO.screw_front_torque
      pt: global
      to: payload
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 1060
  'y': 280
  wires:
    - []
- id: 069f70e3615897de
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
    - p: topic
      vt: str
  repeat: ''
  crontab: ''
  once: true
  onceDelay: '2'
  topic: ''
  payload: ''
  payloadType: date
  x: 560
  'y': 460
  wires:
    - - 182b0b97b21da321
- id: 6ff5ff2ceef04486
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '4'
  payloadType: num
  x: 1190
  'y': 560
  wires:
    - - 4dab851a3090a4ee
- id: ecce777fee31e872
  type: rbe
  z: 71f537202ea9cf55
  name: ''
  func: rbe
  gap: ''
  start: ''
  inout: out
  septopics: true
  property: payload
  topi: topic
  x: 1250
  'y': 380
  wires:
    - - 4dab851a3090a4ee
- id: 40bb5e4c42cb7d30
  type: modbus-read
  z: 71f537202ea9cf55
  name: screw-back
  topic: ''
  showStatusActivities: false
  logIOActivities: false
  showErrors: false
  showWarnings: true
  unitid: '1'
  dataType: HoldingRegister
  adr: '31'
  quantity: '2'
  rate: '400'
  rateUnit: ms
  delayOnStart: false
  startDelayTime: ''
  server: 7c8eaadd51bb903a
  useIOFile: false
  ioFile: ''
  useIOForPayload: false
  emptyMsgOnFail: false
  x: 250
  'y': 200
  wires:
    - - f1b747c79fa6b734
      - e1ce61e1bc0425b5
      - 53b18cf363b9bdfc
    - []
- id: f1b747c79fa6b734
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: IO_70.AI.screw_front_error
      pt: global
      to: 'payload[0]'
      tot: msg
    - t: set
      p: IO_70.AI.screw_front_status
      pt: global
      to: 'payload[1]'
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 480
  'y': 180
  wires:
    - []
- id: 83407c5ab2980f87
  type: modbus-read
  z: 71f537202ea9cf55
  name: back
  topic: ''
  showStatusActivities: false
  logIOActivities: false
  showErrors: false
  showWarnings: true
  unitid: ''
  dataType: HoldingRegister
  adr: '25'
  quantity: '2'
  rate: '200'
  rateUnit: ms
  delayOnStart: false
  startDelayTime: ''
  server: 7c8eaadd51bb903a
  useIOFile: false
  ioFile: ''
  useIOForPayload: false
  emptyMsgOnFail: false
  x: 650
  'y': 200
  wires:
    - - c54fb4f7b0ef4a90
    - []
- id: c54fb4f7b0ef4a90
  type: function
  z: 71f537202ea9cf55
  name: 完成扭矩
  func: |-
    var data = msg.payload[0] + msg.payload[1] * 0xff;
    if (!Number.isNaN(data)) {
        msg.payload = data;
        return msg;
    }
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 800
  'y': 200
  wires:
    - - a1d7c2260b955069
- id: a1d7c2260b955069
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: IO_70.AO.screw_back_torque
      pt: global
      to: payload
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 1060
  'y': 200
  wires:
    - []
- id: aa6e81123ef4575d
  type: modbus-write
  z: 71f537202ea9cf55
  name: screw-back
  showStatusActivities: false
  showErrors: false
  showWarnings: true
  unitid: ''
  dataType: HoldingRegister
  adr: '3'
  quantity: '1'
  server: 7c8eaadd51bb903a
  emptyMsgOnFail: false
  keepMsgProperties: false
  delayOnStart: false
  startDelayTime: ''
  x: 1490
  'y': 680
  wires:
    - []
    - []
- id: a6b590eb006b590d
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '1'
  payloadType: num
  x: 1190
  'y': 680
  wires:
    - - aa6e81123ef4575d
- id: c94c6ad9e72d2877
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '8'
  payloadType: num
  x: 1190
  'y': 720
  wires:
    - - aa6e81123ef4575d
- id: 9fdafbbe3aad3347
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '0'
  payloadType: num
  x: 1190
  'y': 760
  wires:
    - - aa6e81123ef4575d
- id: 9ce39f4bd52c4271
  type: function
  z: 71f537202ea9cf55
  name: screw_back
  func: |-
    var val = 0;
    if (msg.payload.screw_down_run==1){
        val += 1;
    }
    if (msg.payload.screw_down_clockwise==1){
        val += 2;
    }
    if (msg.payload.screw_down_pause == 1) {
        val += 4;
    }
    if (msg.payload.screw_down_reset == 1) {
        val += 8;
    }
    msg.payload = val;
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 1090
  'y': 620
  wires:
    - - 3560840ec135c030
- id: 711fc017dc9da2b2
  type: inject
  z: 71f537202ea9cf55
  name: ''
  props:
    - p: payload
  repeat: ''
  crontab: ''
  once: false
  onceDelay: 0.1
  topic: ''
  payload: '4'
  payloadType: num
  x: 1190
  'y': 800
  wires:
    - - aa6e81123ef4575d
- id: 3560840ec135c030
  type: rbe
  z: 71f537202ea9cf55
  name: ''
  func: rbe
  gap: ''
  start: ''
  inout: out
  septopics: true
  property: payload
  topi: topic
  x: 1250
  'y': 620
  wires:
    - - aa6e81123ef4575d
- id: da8dd0d0db038b93
  type: modbus-write
  z: 71f537202ea9cf55
  name: screw-back-w
  showStatusActivities: false
  showErrors: false
  showWarnings: true
  unitid: '1'
  dataType: MHoldingRegisters
  adr: '5'
  quantity: '1'
  server: 6f8d38c417897cab
  emptyMsgOnFail: false
  keepMsgProperties: false
  delayOnStart: false
  startDelayTime: ''
  x: 620
  'y': 100
  wires:
    - []
    - []
- id: 3e07078bb2ec427d
  type: modbus-write
  z: 71f537202ea9cf55
  name: screw-front-w
  showStatusActivities: false
  showErrors: false
  showWarnings: true
  unitid: '1'
  dataType: MHoldingRegisters
  adr: '17'
  quantity: '1'
  server: 6f8d38c417897cab
  emptyMsgOnFail: false
  keepMsgProperties: false
  delayOnStart: false
  startDelayTime: ''
  x: 600
  'y': 380
  wires:
    - []
    - []
- id: 8d445ec7c975108d
  type: status
  z: 71f537202ea9cf55
  name: ''
  scope:
    - 40bb5e4c42cb7d30
  x: 170
  'y': 580
  wires:
    - - bdf62724a5672db0
- id: 4dc617dbe7df2674
  type: status
  z: 71f537202ea9cf55
  name: ''
  scope:
    - 8d4d4b53cf1b63e2
  x: 150
  'y': 640
  wires:
    - - 553bc77afa5a1079
- id: 1a0a7423ea788726
  type: file
  z: 71f537202ea9cf55
  name: ''
  filename: 'c:\tmp\back.log'
  filenameType: str
  appendNewline: true
  createDir: false
  overwriteFile: 'false'
  encoding: none
  x: 740
  'y': 580
  wires:
    - []
- id: bdf62724a5672db0
  type: rbe
  z: 71f537202ea9cf55
  name: ''
  func: rbe
  gap: ''
  start: ''
  inout: out
  septopics: true
  property: status.text
  topi: topic
  x: 390
  'y': 580
  wires:
    - - b7f739ccd1ffcd15
- id: b7f739ccd1ffcd15
  type: function
  z: 71f537202ea9cf55
  name: 函数 20
  func: |-
    var txt = msg.status.text;
    var date = (new Date()).toISOString();
    msg.payload = date + " : " + txt;
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 560
  'y': 580
  wires:
    - - 1a0a7423ea788726
- id: 647d8c77d301f6a8
  type: file
  z: 71f537202ea9cf55
  name: ''
  filename: 'c:\tmp\front.log'
  filenameType: str
  appendNewline: true
  createDir: false
  overwriteFile: 'false'
  encoding: none
  x: 740
  'y': 640
  wires:
    - []
- id: 553bc77afa5a1079
  type: rbe
  z: 71f537202ea9cf55
  name: ''
  func: rbe
  gap: ''
  start: ''
  inout: out
  septopics: true
  property: status.text
  topi: topic
  x: 390
  'y': 640
  wires:
    - - e8065de45cfa0815
- id: e8065de45cfa0815
  type: function
  z: 71f537202ea9cf55
  name: 函数 21
  func: |-
    var txt = msg.status.text;
    var date = (new Date()).toISOString();
    msg.payload = date + " : " + txt;
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 560
  'y': 640
  wires:
    - - 647d8c77d301f6a8
- id: c2215fbee5d7646e
  type: function
  z: 71f537202ea9cf55
  name: 故障检测
  func: |-


    var error = msg.payload[0];
    var result = msg.payload[1];
    if (result == 1 && error > 0) {
        result = 3;
    }

    msg.payload = [result]
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 440
  'y': 380
  wires:
    - - 3e07078bb2ec427d
- id: e1ce61e1bc0425b5
  type: function
  z: 71f537202ea9cf55
  name: 故障检测
  func: |-
    var error = msg.payload[0];
    var result = msg.payload[1];
    if (result == 1 && error > 0) {
        result = 3;
    }

    msg.payload = [result]
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 460
  'y': 100
  wires:
    - - da8dd0d0db038b93
- id: 8c0135732e0ed9b9
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: payload
      pt: msg
      to: 'payload[1]'
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 395
  'y': 340
  wires:
    - - ffd12dc77501f486
  l: false
- id: ffd12dc77501f486
  type: rbe
  z: 71f537202ea9cf55
  name: ''
  func: rbe
  gap: ''
  start: ''
  inout: out
  septopics: true
  property: payload
  topi: topic
  x: 455
  'y': 340
  wires:
    - - a900078fe5ad1eac
  l: false
- id: 20e1855f7fac6cee
  type: function
  z: 71f537202ea9cf55
  name: 扭力数组
  func: |-
    var torques = global.get("front_torque");
    var IO = global.get("IO_70");
    torques.push(IO.AO.screw_front_torque);
    torques.shift();
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 600
  'y': 340
  wires:
    - []
- id: a900078fe5ad1eac
  type: switch
  z: 71f537202ea9cf55
  name: ''
  property: payload
  propertyType: msg
  rules:
    - t: eq
      v: '1'
      vt: num
  checkall: 'true'
  repair: false
  outputs: 1
  x: 505
  'y': 340
  wires:
    - - 20e1855f7fac6cee
  l: false
- id: 53b18cf363b9bdfc
  type: change
  z: 71f537202ea9cf55
  name: ''
  rules:
    - t: set
      p: payload
      pt: msg
      to: 'payload[1]'
      tot: msg
  action: ''
  property: ''
  from: ''
  to: ''
  reg: false
  x: 415
  'y': 140
  wires:
    - - 7d2274a9925015b8
  l: false
- id: 7d2274a9925015b8
  type: rbe
  z: 71f537202ea9cf55
  name: ''
  func: rbe
  gap: ''
  start: ''
  inout: out
  septopics: true
  property: payload
  topi: topic
  x: 475
  'y': 140
  wires:
    - - aafb606891a6a420
  l: false
- id: fb5620700b1981ea
  type: function
  z: 71f537202ea9cf55
  name: 扭力数组
  func: |-
    var torques = global.get("back_torque");
    var IO = global.get("IO_70");
    torques.push(IO.AO.screw_back_torque);
    torques.shift();
    return msg;
  outputs: 1
  timeout: 0
  noerr: 0
  initialize: ''
  finalize: ''
  libs: []
  x: 620
  'y': 140
  wires:
    - []
- id: aafb606891a6a420
  type: switch
  z: 71f537202ea9cf55
  name: ''
  property: payload
  propertyType: msg
  rules:
    - t: eq
      v: '1'
      vt: num
  checkall: 'true'
  repair: false
  outputs: 1
  x: 525
  'y': 140
  wires:
    - - fb5620700b1981ea
  l: false
